{% extends 'baseUser.html' %}
{% load static %}

{% block title %}Chat{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/ChatDetail.css' %}">
<style>
    .left-nav {
        display: none;
    }
    .header-icons {
        display: none;
    }
    .main-content {
        margin-left: 0;
        width: 100%;
    }
    .delete-button {
        background-color: red;
        color: white;
        padding: 10px 20px;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        display: flex;
        align-items: center;
        gap: 8px;
        text-decoration: none;
        margin-top: 15px;
    }
    .delete-button:hover {
        background-color: #c82333;
    }
    
    .delete-button i {
        font-size: 14px;
    }

    .back-button {
        display: flex;
        align-items: center;
        color: white;
        text-decoration: none;
        font-weight: 500;
        background-color: #007bff;
        padding: 10px 20px;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        gap: 8px;
        margin-top: 15px;
    }

    .back-button:hover {
        background-color: #0056b3;
    }

    .back-button i {
        margin-right: 8px;
    }
</style>
{% endblock %}

{% block header_left %}
<div class="logo">
    <img src="{% static 'images/logo.jpg' %}" alt="MemRise Logo" class="memrise-logo">
</div>
<a href="{%url 'homeChat' %}" class="back-button">
    <i class="fas fa-arrow-left"></i>
    Rời phòng
</a>
{% endblock %}

{% block header_title %}
{% if host.id == data.nguoitao.id %}
    <a href="" class="delete-button">
        <i class="fa-solid fa-trash"></i>
        Hủy
    </a>
{% else %}
    <p>Trò chuyện</p>
{% endif %}
{% endblock %}

{% block content %}
<br>
<p class="text" style="text-align: center; color: blue;">Tiêu đề: {{detail.tieude}}</p>
<main class="main-content">
    <!-- Chat Messages -->
    {% for msg in messages %}
        {% if msg.nguoigui.id == host.id %}
            <div class="message user-message" style="margin:10px">
                <div class="message-content">
                    <p class="english">{{ msg.tinnhan }}</p>
                </div>
            </div>
        {% else %}
            <div class="message bot-message" style="margin:10px" >
                <div class="message-content">
                    <p>{{ msg.tinnhan }}</p>
                </div>
            </div>
        {% endif %}
    {% endfor %}
</main>

<!-- Chat Input -->
<div class="chat-input-container">
    <div class="chat-input-area">
        <form method="post"> 
            {% csrf_token %}
            <!-- Lưu trữ dữ liệu qua hidden fields -->
            <input type="hidden" name="current_index" value="{{ current_index }}">
            <input type="hidden" name="reply_data" value="{{ reply_data }}">
            
            <div class="input-field">
                <input type="text" placeholder="Nhập tin nhắn của bạn..." name="ChatContent">
                <button type="submit" class="send-btn"><i class="fas fa-paper-plane"></i></button>
            </div>
        </form>
    </div>
</div>
{% endblock %}
