{% load static %}
<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ôn tập từ vựng</title>
    <link rel="stylesheet" href="{% static 'css/ontap.css' %}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>
    <header class="app-header">
        <div class="logo">
            <img src="{% static 'images/school.png' %}" alt="Logo">
        </div>
        <div class="title">Ôn tập từ vựng</div>
        <div class="actions">
            <button class="keyboard-btn"><i class="fas fa-keyboard"></i></button>
            <button class="close-btn"><i class="fas fa-times"></i></button>
        </div>
    </header>

    <div class="progress-bar">
        <div class="progress" id="progress" style="width: 0%;"></div>
    </div>

    <main class="content">
        <div class="lesson-container">
            <div class="video-container">
                <div id="img-hinhanh-container"></div>
            </div>

            <div class="translation-container">
                <div class="language-section">
                    <div class="language-label">ENGLISH (US)</div>
                    <div class="word" id="tu-anh">Loading...</div>
                </div>

                <div class="language-section">
                    <div class="language-label">VIETNAMESE</div>
                    <div class="word" id="tu-viet">Loading...</div>
                </div>

                <div class="divider"></div>

                <div class="sound-section">
                    <div class="sound-label">ÂM THANH</div>
                    <div class="sound-buttons">
                        <button class="sound-btn" onclick="playAudio()"><i class="fas fa-volume-up"></i></button>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <div class="next-button-container">
        <button class="next-button" onclick="nextWord()">
            <span>Tiếp</span>
            <i class="fas fa-chevron-right"></i>
        </button>
    </div>

    <script>
        const tuVungList = {{ tu_vung_list|safe }};
        console.log("Từ vựng ôn tập:", tuVungList);

        let index = 0;
        let audio = null;

        function loadWord() {
            if (!tuVungList || tuVungList.length === 0) {
                alert("Không có từ vựng nào để ôn tập.");
                return;
            }

            const tu = tuVungList[index];
            document.getElementById("tu-anh").innerText = tu.Tu || "[Không có từ]";
            document.getElementById("tu-viet").innerText = tu.Dich || "[Không có nghĩa]";

            // Hiển thị hình ảnh nếu có, nếu không thì xóa ảnh
            const imgContainer = document.getElementById("img-hinhanh-container");
            imgContainer.innerHTML = "";
            if (tu.HinhAnh) {
                const img = document.createElement("img");
                img.src = "/media/" + tu.HinhAnh;
                img.alt = tu.Tu;
                img.className = "video-thumbnail";
                imgContainer.appendChild(img);
            }

            if (tu.PhatAm) {
                audio = new Audio(`/media/${tu.PhatAm}`);
            } else {
                audio = null;
            }

            const percent = ((index + 1) / tuVungList.length) * 100;
            document.getElementById("progress").style.width = percent + "%";
        }

        function nextWord() {
            if (index < tuVungList.length - 1) {
                index++;
                loadWord();
            } else {
                window.location.href = "/hoanthanh/ontap/";
            }
        }

        function playAudio() {
            if (audio) {
                audio.play();
            } else {
                alert("Không có âm thanh cho từ này.");
            }
        }

        window.onload = () => loadWord();
    </script>
</body>
</html> 